from backend.models import VulnerabilityCategory
from backend.serializers.vulnerability_category import VulnerabilityCategorySerializer
from pecoret.core.viewsets import PeCoReTReadOnlyModelViewSet
from pecoret.core import permissions


class VulnerabilityCategoryViewSet(PeCoReTReadOnlyModelViewSet):
    permission_classes = [permissions.PRESET_GROUP_SUPERUSER_OR_READ_ONLY]
    serializer_class = VulnerabilityCategorySerializer
    queryset = VulnerabilityCategory.objects.all()
    api_scope = None
    search_fields = ["name", "category_id"]
