from rest_framework import serializers
from pecoret.core.serializers import ValuedChoiceField
from backend.models.vulnerability import ProjectVulnerability, VulnerabilityTemplate, Severity


class BaseVulnerabilitySerializer(serializers.ModelSerializer):
    pass


class VulnerabilityTemplateSerializer(serializers.ModelSerializer):
    severity = ValuedChoiceField(choices=Severity.choices)

    class Meta:
        model = VulnerabilityTemplate
        fields = [
            "pk", "severity", "vulnerability_id", "name", "description",
            "recommendation", "cwe_id", "categories"
        ]


class ProjectVulnerabilitySerializer(serializers.ModelSerializer):
    severity = ValuedChoiceField(choices=Severity.choices)

    class Meta:
        model = ProjectVulnerability
        fields = [
            "pk", "severity", "vulnerability_id", "name", "description",
            "recommendation", "cwe_id", "categories"
        ]
