from pecoret.reporting.template import VulnerabilityCSVTemplate
from backend.models import Finding
from .base import DefaultBaseTemplate


class VulnerabilityCSVReport(VulnerabilityCSVTemplate, DefaultBaseTemplate):
    def get_context(self):
        context = super().get_context()
        context["findings"] = Finding.objects.for_report(self.get_project())
        return context
